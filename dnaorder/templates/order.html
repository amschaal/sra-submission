{% extends 'base.html' %}
{% block content %}
<style>
.modal{
  width:90%;
  max-height:90%;
}
</style>
<h3>Order {{order.id}}</h3>
<table>
<tr><th>Submitted</th><td>{{order.submitted}}</td></tr>
<tr><th>Name</th><td>{{order.name}}</td></tr>
<tr><th>Email</th><td>{{order.email}}</td></tr>
<tr><th>Phone</th><td>{{order.phone}}</td></tr>
<tr><th>PI</th><td>{{order.pi_name}}</td></tr>
<tr><th>PI email</th><td>{{order.pi_email}}</td></tr>
<tr><th>Institute</th><td>{{order.institute}}</td></tr>
<tr><th>Type</th><td>{{order.type}}</td></tr>
<tr><th># Samples</th><td><span title="{% for s in order.sample_ids %}{{s}}{% if not forloop.last %}, {% endif %}{% endfor %}">{{order.sample_ids|length}}</span> </td></tr>
<tr>
	<th>Samplesheet</th>
	<td>
	<a id="view_samples" class="modal-trigger btn" href="#samples_modal">View</a>
  <!-- Dropdown Trigger -->
  <a class='dropdown-button btn' href='#' data-activates='download-samples'>Download</a>

  <!-- Dropdown Structure -->
  <ul id='download-samples' class='dropdown-content'>
    <li><a href="{% url 'download' id=order.id %}?data=samples&format=original">Original</a></li>
    <li><a href="{% url 'download' id=order.id %}?data=samples&format=csv">CSV</a></li>
    <li><a href="{% url 'download' id=order.id %}?data=samples&format=xlsx">XLSX</a></li>
    <!-- 
    <li><a href="#!">two</a></li>
    <li class="divider"></li>
    <li><a href="#!">three</a></li>
    <li><a href="#!"><i class="material-icons">view_module</i>four</a></li>
	 -->
  </ul>
	</td>
</tr>
{% if order.sra_form %}
<tr><th>SRA samplesheet</th>
	<td>
	<a id="view_sra" class="modal-trigger btn" href="#sra_modal">View</a>
	  <!-- Dropdown Trigger -->
	  <a class='dropdown-button btn' href='#' data-activates='download-sra'>Download</a>
	
	  <!-- Dropdown Structure -->
	  <ul id='download-sra' class='dropdown-content'>
	    <li><a href="{% url 'download' id=order.id %}?data=sra&format=original">Original</a></li>
	    <li><a href="{% url 'download' id=order.id %}?data=sra&format=csv">CSV</a></li>
	    <li><a href="{% url 'download' id=order.id %}?data=sra&format=xlsx">XLSX</a></li>
	    <li class="divider"></li>
	    <li><a href="{% url 'download' id=order.id %}?data=combined&format=csv">Combined CSV</a></li>
	    <li><a href="{% url 'download' id=order.id %}?data=combined&format=xlsx">Combined XLSX</a></li>
	  </ul>
	</td>
</tr>
{% endif %}
</table>
{% include 'partials/modal.html'%}
<script>




$(document).ready(function(){
{% if order.samplesheet %}
	var samplesheet = {{order.samplesheet.to_json|safe}};
	var sample_modal = new spreadsheet_modal(samplesheet,{title:'Samplesheet'});
	$('#view_samples').click(function(){
		sample_modal.open();
	});
{% endif %}
{% if order.sra_samplesheet %}
	var sra_samplesheet = {{order.sra_samplesheet.to_json|safe}};
	var sra_modal = new spreadsheet_modal(sra_samplesheet,{title:'SRA Samplesheet'});
	$('#view_sra').click(function(){
		sra_modal.open();
	});
{% endif %}
});

</script>


{% endblock %}